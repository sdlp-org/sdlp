<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>SDLP Electron Demo</title>
    <link rel="icon" href="../../resources/icon.png" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline';"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">
          SDLP Demo Application
        </h1>
        <p class="text-gray-600">Secure Deep Link Protocol Demonstration</p>
      </header>

      <main class="max-w-6xl mx-auto">
        <!-- Tab Navigation -->
        <div class="mb-6">
          <nav
            class="flex space-x-1 bg-white rounded-lg shadow-sm p-1"
            role="tablist"
          >
            <button
              id="home-tab"
              class="tab-button flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors duration-200 bg-blue-500 text-white"
              data-tab="home"
              role="tab"
              aria-selected="true"
            >
              Home
            </button>
            <button
              id="examples-tab"
              class="tab-button flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors duration-200 text-gray-500 hover:text-gray-700"
              data-tab="examples"
              role="tab"
              aria-selected="false"
            >
              Examples
            </button>
            <button
              id="tools-tab"
              class="tab-button flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors duration-200 text-gray-500 hover:text-gray-700"
              data-tab="tools"
              role="tab"
              aria-selected="false"
            >
              Tools
            </button>
          </nav>
        </div>

        <!-- Home Tab Content -->
        <div
          id="home-content"
          class="tab-content"
          role="tabpanel"
          aria-labelledby="home-tab"
        >
          <!-- Status Section - Main Area -->
          <div id="status-section">
            <div id="status-card" class="bg-white rounded-lg shadow-md p-6">
              <div id="loading-state" class="text-center">
                <div
                  class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4"
                >
                  <svg
                    class="w-8 h-8 text-blue-500"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                </div>
                <h3 class="text-lg font-medium text-gray-800 mb-2">
                  Ready to Verify Links
                </h3>
                <p class="text-gray-600 mb-4">
                  Click on an example link or open an SDLP link from your system
                </p>

                <!-- Demo Warning -->
                <div
                  class="bg-orange-50 border border-orange-200 rounded-lg p-4 max-w-md mx-auto"
                >
                  <div class="flex items-start space-x-3">
                    <div
                      class="w-5 h-5 text-orange-600 mt-0.5 flex items-center justify-center"
                    >
                      ⚠️
                    </div>
                    <div class="text-left">
                      <p class="text-sm font-medium text-orange-800 mb-1">
                        Demo Warning
                      </p>
                      <p class="text-sm text-orange-700">
                        This demo <strong>executes shell commands</strong> from
                        verified SDLP payloads to demonstrate the power and
                        security implications of deep links. This shows why
                        cryptographic verification is essential.
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div id="success-state" class="hidden">
                <div class="space-y-4">
                  <!-- Verification Status -->
                  <div class="flex items-center space-x-3">
                    <div
                      class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M5 13l4 4L19 7"
                        ></path>
                      </svg>
                    </div>
                    <span class="text-lg font-medium text-green-800"
                      >Link Verified</span
                    >
                  </div>

                  <!-- Sender Verification -->
                  <div class="flex items-center space-x-3">
                    <div
                      class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M5 13l4 4L19 7"
                        ></path>
                      </svg>
                    </div>
                    <div>
                      <span class="text-lg font-medium text-green-800"
                        >Verified From</span
                      >
                      <div
                        id="sender-info"
                        class="text-sm text-gray-600 mt-1"
                      ></div>
                    </div>
                  </div>
                </div>

                <!-- Processed Payload Section -->
                <div class="mt-6 bg-gray-50 rounded-lg p-4">
                  <h4 class="font-medium text-gray-800 mb-3">
                    Processed Payload
                  </h4>
                  <div class="space-y-3">
                    <div>
                      <div class="text-xs font-medium text-gray-600 mb-1">
                        Command:
                      </div>
                      <div class="bg-white rounded border p-3">
                        <code
                          id="command-text"
                          class="text-sm font-mono text-gray-700 break-all whitespace-pre-wrap block"
                        ></code>
                      </div>
                    </div>
                    <div class="mt-4">
                      <button
                        id="execute-command-btn"
                        class="w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors"
                      >
                        Execute Command
                      </button>
                    </div>
                    <div id="command-output-section" class="hidden">
                      <div class="text-xs font-medium text-gray-600 mb-1">
                        Output:
                      </div>
                      <div class="bg-black rounded p-3">
                        <div
                          id="command-output"
                          class="text-green-400 font-mono text-sm break-all whitespace-pre-wrap"
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div id="error-state" class="hidden">
                <div class="space-y-4">
                  <!-- Verification Failed -->
                  <div class="flex items-center space-x-3">
                    <div
                      class="w-6 h-6 bg-red-500 rounded-full flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M6 18L18 6M6 6l12 12"
                        ></path>
                      </svg>
                    </div>
                    <span class="text-lg font-medium text-red-800"
                      >Link Verification Failed</span
                    >
                  </div>

                  <!-- Error Details -->
                  <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <p class="text-sm text-red-800">
                      <strong>Error:</strong> <span id="error-message"></span>
                    </p>
                  </div>
                </div>
              </div>

              <div id="untrusted-state" class="hidden">
                <div class="space-y-4">
                  <!-- Link Verified -->
                  <div class="flex items-center space-x-3">
                    <div
                      class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M5 13l4 4L19 7"
                        ></path>
                      </svg>
                    </div>
                    <span class="text-lg font-medium text-green-800"
                      >Link Verified</span
                    >
                  </div>

                  <!-- Untrusted Source Warning -->
                  <div class="flex items-center space-x-3">
                    <div
                      class="w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center"
                    >
                      <svg
                        class="w-4 h-4 text-white"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                        ></path>
                      </svg>
                    </div>
                    <div>
                      <span class="text-lg font-medium text-yellow-800"
                        >Verified From</span
                      >
                      <div
                        id="untrusted-info"
                        class="text-sm text-gray-600 mt-1"
                      ></div>
                    </div>
                  </div>

                  <!-- Warning Message -->
                  <div
                    class="bg-yellow-50 border border-yellow-200 rounded-lg p-3"
                  >
                    <div class="flex items-start space-x-3">
                      <div class="w-5 h-5 text-yellow-600 mt-0.5">
                        <svg
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                          ></path>
                        </svg>
                      </div>
                      <div>
                        <p class="text-sm font-medium text-yellow-800 mb-1">
                          Untrusted Source
                        </p>
                        <p class="text-sm text-yellow-700">
                          This link is cryptographically valid but comes from an
                          unknown or untrusted source. Proceed with caution.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Processed Payload Section -->
                <div class="mt-6 bg-gray-50 rounded-lg p-4">
                  <h4 class="font-medium text-gray-800 mb-3">
                    Processed Payload
                  </h4>
                  <div class="space-y-3">
                    <div>
                      <div class="text-xs font-medium text-gray-600 mb-1">
                        Command:
                      </div>
                      <div class="bg-white rounded border p-3">
                        <code
                          id="untrusted-command-text"
                          class="text-sm font-mono text-gray-700 break-all whitespace-pre-wrap block"
                        ></code>
                      </div>
                    </div>
                    <div class="mt-4">
                      <button
                        id="execute-untrusted-command-btn"
                        class="w-full px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-colors"
                      >
                        Execute Command
                      </button>
                    </div>
                    <div id="untrusted-output-section" class="hidden">
                      <div class="text-xs font-medium text-gray-600 mb-1">
                        Output:
                      </div>
                      <div class="bg-black rounded p-3">
                        <div
                          id="untrusted-output"
                          class="text-green-400 font-mono text-sm break-all whitespace-pre-wrap"
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Terminal Section -->
          <div id="terminal-section" class="hidden mt-6">
            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">
                Command Output
              </h3>
              <div class="bg-black rounded-lg p-4">
                <div id="terminal"></div>
              </div>
            </div>
          </div>

          <!-- Protocol Introduction -->
          <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">What is SDLP?</h2>
            <div class="prose text-gray-600">
              <p class="mb-4">
                The <strong>Secure Deep Link Protocol (SDLP)</strong> is a
                cryptographic protocol that ensures the integrity and
                authenticity of deep links. Unlike regular URLs, SDLP links are
                digitally signed, allowing you to verify:
              </p>
              <ul class="list-disc list-inside mb-4 space-y-2">
                <li>
                  <strong>Who sent the link</strong> - Cryptographic proof of
                  the sender's identity
                </li>
                <li>
                  <strong>Content integrity</strong> - Guarantee that the
                  payload hasn't been tampered with
                </li>
                <li>
                  <strong>Trust level</strong> - Clear indication of whether the
                  sender is trusted
                </li>
              </ul>
              <p>
                This prevents common attacks like link tampering, phishing, and
                man-in-the-middle modifications that plague traditional deep
                links.
              </p>
            </div>
          </div>

          <!-- Trusted Keys Management -->
          <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">
              🔐 Trusted Keys
            </h3>
            <p class="text-gray-600 mb-4">
              Manage your trusted SDLP senders. Keys added here will be automatically trusted for future links.
            </p>
            
            <div id="trusted-keys-section">
              <div id="trusted-keys-loading" class="text-center py-4">
                <div class="text-gray-500">Loading trusted keys...</div>
              </div>
              
              <div id="trusted-keys-empty" class="hidden text-center py-8">
                <div class="text-gray-500 mb-2">No trusted keys yet</div>
                <p class="text-sm text-gray-400">
                  When you encounter valid SDLP links from new senders, you can choose to trust them for future interactions.
                </p>
              </div>
              
              <div id="trusted-keys-list" class="hidden space-y-3">
                <!-- Trusted keys will be populated here -->
              </div>
              
              <div id="trusted-keys-actions" class="hidden mt-4 pt-4 border-t border-gray-200">
                <button
                  id="refresh-trusted-keys-btn"
                  class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm mr-2"
                >
                  Refresh
                </button>
                <button
                  id="clear-all-trusted-keys-btn"
                  class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm"
                >
                  Clear All
                </button>
              </div>
            </div>
          </div>

          <!-- Getting Started -->
          <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">
              Getting Started
            </h3>
            <p class="text-gray-600 mb-4">
              Explore the SDLP protocol through interactive examples and tools:
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="border rounded-lg p-4">
                <h4 class="font-medium text-blue-700 mb-2">📋 Examples</h4>
                <p class="text-sm text-gray-600 mb-3">
                  View detailed examples of SDLP links with formatted payloads,
                  keys, and verification results.
                </p>
                <button
                  id="go-to-examples"
                  class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm"
                >
                  View Examples
                </button>
              </div>
              <div class="border rounded-lg p-4">
                <h4 class="font-medium text-green-700 mb-2">🛠️ Tools</h4>
                <p class="text-sm text-gray-600 mb-3">
                  Generate your own SDLP links and verify existing ones with our
                  interactive tools.
                </p>
                <button
                  id="go-to-tools"
                  class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors text-sm"
                >
                  Open Tools
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Examples Tab Content -->
        <div
          id="examples-content"
          class="tab-content hidden"
          role="tabpanel"
          aria-labelledby="examples-tab"
        >
          <div class="space-y-6">
            <!-- Valid Link Example -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <div class="flex items-center justify-between mb-4">
                <div>
                  <h3 class="text-xl font-semibold text-green-700">
                    ✅ Valid SDLP Link
                  </h3>
                  <p class="text-gray-600">
                    A properly signed link that will verify successfully
                  </p>
                </div>
                <button
                  id="example-valid-link"
                  class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors"
                >
                  Test This Link
                </button>
              </div>

              <div class="space-y-4">
                <div>
                  <h4 class="font-medium text-gray-800 mb-2">Payload</h4>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <pre
                      id="valid-payload"
                      class="text-sm text-gray-700 font-mono"
                    ></pre>
                  </div>
                </div>

                <div>
                  <h4 class="font-medium text-gray-800 mb-2">
                    Signing Key (Public)
                  </h4>
                  <div class="bg-gray-50 rounded-lg p-3">
                    <pre
                      id="valid-key"
                      class="text-sm text-gray-700 font-mono"
                    ></pre>
                  </div>
                </div>

                <div>
                  <h4 class="font-medium text-gray-800 mb-2">SDLP Link</h4>
                  <div class="bg-gray-50 rounded-lg p-3 overflow-hidden">
                    <pre
                      id="valid-link"
                      class="text-sm text-gray-700 font-mono break-all whitespace-pre-wrap"
                    ></pre>
                  </div>
                </div>
              </div>
            </div>

            <!-- Failure Mode Examples -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <div class="mb-4">
                <h3 class="text-xl font-semibold text-red-700">
                  ❌ Failure Mode Examples
                </h3>
                <p class="text-gray-600">
                  Different ways SDLP links can fail verification with detailed breakdowns
                </p>
              </div>

              <div class="space-y-6">
                <!-- Payload Tampering -->
                <div class="border border-red-200 rounded-lg p-6 bg-red-50">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-medium text-red-800">🔧 Payload Tampering</h4>
                    <button
                      id="example-invalid-link"
                      class="px-4 py-2 bg-red-500 text-white rounded text-sm hover:bg-red-600 transition-colors"
                    >
                      Test This Link
                    </button>
                  </div>
                  
                  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div>
                      <h5 class="font-medium text-red-800 mb-2">What Happens</h5>
                      <p class="text-sm text-red-700 mb-3">
                        Link content is modified after signing, breaking the cryptographic signature.
                      </p>
                      
                      <h5 class="font-medium text-red-800 mb-2">Original Payload</h5>
                      <div class="bg-white rounded p-2 mb-3">
                        <code class="text-xs text-gray-700">echo "Original payload"</code>
                      </div>
                      
                      <h5 class="font-medium text-red-800 mb-2">Why It Fails</h5>
                      <p class="text-xs text-red-700">
                        The signature was created for the original payload, but the link now contains corrupted data. 
                        SDLP detects this mismatch and rejects the link.
                      </p>
                    </div>
                    
                    <div>
                      <h5 class="font-medium text-red-800 mb-2">Corrupted SDLP Link</h5>
                      <div class="bg-white rounded p-2">
                        <code id="corrupted-link-display" class="text-xs text-red-600 break-all">
                          Loading...
                        </code>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Malformed Link -->
                <div class="border border-red-200 rounded-lg p-6 bg-red-50">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-medium text-red-800">📋 Malformed Link</h4>
                    <button
                      id="example-malformed-link"
                      class="px-4 py-2 bg-red-500 text-white rounded text-sm hover:bg-red-600 transition-colors"
                    >
                      Test This Link
                    </button>
                  </div>
                  
                  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div>
                      <h5 class="font-medium text-red-800 mb-2">What Happens</h5>
                      <p class="text-sm text-red-700 mb-3">
                        SDLP link has invalid JWT structure - missing or corrupted components.
                      </p>
                      
                      <h5 class="font-medium text-red-800 mb-2">Expected Structure</h5>
                      <div class="bg-white rounded p-2 mb-3">
                        <code class="text-xs text-gray-700">sdlp://header.payload.signature</code>
                      </div>
                      
                      <h5 class="font-medium text-red-800 mb-2">Why It Fails</h5>
                      <p class="text-xs text-red-700">
                        SDLP links must follow JWT format. This link has invalid structure that cannot be parsed.
                      </p>
                    </div>
                    
                    <div>
                      <h5 class="font-medium text-red-800 mb-2">Malformed SDLP Link</h5>
                      <div class="bg-white rounded p-2">
                        <code id="malformed-link-display" class="text-xs text-red-600 break-all">
                          Loading...
                        </code>
                      </div>
                    </div>
                  </div>
                </div>


                <!-- Different Signer -->
                <div class="border border-yellow-200 rounded-lg p-6 bg-yellow-50">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="text-lg font-medium text-yellow-800">🔑 Different Signer</h4>
                    <button
                      id="example-wrong-key-link"
                      class="px-4 py-2 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600 transition-colors"
                    >
                      Test This Link
                    </button>
                  </div>
                  
                  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div>
                      <h5 class="font-medium text-yellow-800 mb-2">What Happens</h5>
                      <p class="text-sm text-yellow-700 mb-3">
                        Link is cryptographically valid but signed with a different key than the trusted one.
                      </p>
                      
                      <h5 class="font-medium text-yellow-800 mb-2">Demo Payload</h5>
                      <div class="bg-white rounded p-2 mb-3">
                        <code class="text-xs text-gray-700">echo "Key mismatch demo"</code>
                      </div>
                      
                      <h5 class="font-medium text-yellow-800 mb-2">Why It Shows as Untrusted</h5>
                      <p class="text-xs text-yellow-700">
                        The signature is valid, but it's from a different signer than expected. SDLP's trust system correctly identifies this as an untrusted source, demonstrating key-based identity verification.
                      </p>
                    </div>
                    
                    <div>
                      <h5 class="font-medium text-yellow-800 mb-2">Different Signer SDLP Link</h5>
                      <div class="bg-white rounded p-2">
                        <code id="key-mismatch-link-display" class="text-xs text-yellow-600 break-all">
                          Loading...
                        </code>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="mt-6 bg-red-50 border border-red-200 rounded-lg p-4">
                <div class="flex items-start space-x-3">
                  <div class="w-5 h-5 text-red-600 mt-0.5">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                    </svg>
                  </div>
                  <div>
                    <p class="text-sm font-medium text-red-800 mb-1">
                      Security Protection
                    </p>
                    <p class="text-sm text-red-700">
                      These examples demonstrate why cryptographic verification is essential. 
                      SDLP's signature verification prevents execution of tampered, expired, or fraudulent links, 
                      protecting users from malicious attacks that are common with traditional deep links.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Trust Model Explanation -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <div class="mb-4">
                <h3 class="text-xl font-semibold text-blue-700">
                  🔐 Trust Model
                </h3>
                <p class="text-gray-600">
                  Understanding SDLP's three-state trust system
                </p>
              </div>

              <div class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <!-- Trusted State -->
                  <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                    <div class="flex items-center mb-2">
                      <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                      </div>
                      <h4 class="font-medium text-green-800">Trusted</h4>
                    </div>
                    <p class="text-sm text-green-700">
                      Sender is in your trust store. Links proceed with minimal friction.
                    </p>
                  </div>

                  <!-- Untrusted State -->
                  <div class="border border-yellow-200 rounded-lg p-4 bg-yellow-50">
                    <div class="flex items-center mb-2">
                      <div class="w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center mr-2">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                        </svg>
                      </div>
                      <h4 class="font-medium text-yellow-800">Untrusted</h4>
                    </div>
                    <p class="text-sm text-yellow-700">
                      Valid but unknown sender. Shows TOFU options: "Trust this Sender" or "Proceed Once".
                    </p>
                  </div>

                  <!-- Invalid State -->
                  <div class="border border-red-200 rounded-lg p-4 bg-red-50">
                    <div class="flex items-center mb-2">
                      <div class="w-6 h-6 bg-red-500 rounded-full flex items-center justify-center mr-2">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                      </div>
                      <h4 class="font-medium text-red-800">Invalid</h4>
                    </div>
                    <p class="text-sm text-red-700">
                      Cryptographic verification failed. Link is blocked for security.
                    </p>
                  </div>
                </div>

                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <div class="flex items-start space-x-3">
                    <div class="w-5 h-5 text-blue-600 mt-0.5">
                      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    </div>
                    <div>
                      <p class="text-sm font-medium text-blue-800 mb-1">
                        Trust on First Use (TOFU)
                      </p>
                      <p class="text-sm text-blue-700">
                        All senders start as untrusted. When you encounter a valid link from an unknown sender, 
                        you can choose to "Trust this Sender" to add them to your trust store for future interactions, 
                        or "Proceed Once" to execute without trusting.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tools Tab Content -->
        <div
          id="tools-content"
          class="tab-content hidden"
          role="tabpanel"
          aria-labelledby="tools-tab"
        >
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Link Generator -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">
                🔗 Link Generator
              </h3>
              <p class="text-gray-600 mb-4">
                Create a signed SDLP link from your payload
              </p>

              <div class="space-y-4">
                <div>
                  <label
                    for="payload-input"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    Payload (Command to execute)
                  </label>
                  <textarea
                    id="payload-input"
                    rows="3"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder='echo "Hello from SDLP!"'
                  ></textarea>
                </div>

                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                  <p class="text-sm text-blue-800">
                    <strong>🔑 Signing Key:</strong> Links will be signed with
                    the trusted demo key, making them appear as trusted sources.
                  </p>
                </div>

                <button
                  id="generate-link-btn"
                  class="w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"
                >
                  Generate SDLP Link
                </button>

                <div id="generated-link-section" class="hidden">
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >Generated Link</label
                  >
                  <div class="flex mb-3">
                    <input
                      id="generated-link"
                      type="text"
                      readonly
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-l-md bg-gray-50 text-sm"
                    />
                    <button
                      id="copy-link-btn"
                      class="px-4 py-2 bg-gray-500 text-white rounded-r-md hover:bg-gray-600 transition-colors"
                    >
                      Copy
                    </button>
                  </div>
                  <button
                    id="open-generated-link-btn"
                    class="w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors"
                  >
                    🚀 Open Link (Test with Dialog)
                  </button>
                </div>
              </div>
            </div>

            <!-- Link Verifier -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-xl font-semibold text-gray-800 mb-4">
                🔍 Link Verifier
              </h3>
              <p class="text-gray-600 mb-4">
                Verify the authenticity of an SDLP link
              </p>

              <div class="space-y-4">
                <div>
                  <label
                    for="link-input"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    SDLP Link
                  </label>
                  <textarea
                    id="link-input"
                    rows="3"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Paste an SDLP link here..."
                  ></textarea>
                </div>

                <button
                  id="verify-link-btn"
                  class="w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors"
                >
                  Verify Link
                </button>

                <div id="verification-result" class="hidden">
                  <div class="border rounded-lg p-4">
                    <div id="verification-status"></div>
                    <div id="verification-details" class="mt-3 text-sm"></div>
                    <div id="verification-actions" class="mt-4 hidden">
                      <button
                        id="open-verified-link-btn"
                        class="w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors"
                      >
                        🚀 Open Link (Test with Dialog)
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script type="module" src="./index.ts"></script>
  </body>
</html>
