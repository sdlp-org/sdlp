<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; }
      .label { font-family: Arial, sans-serif; font-size: 12px; fill: #333; }
      .box { fill: #f0f8ff; stroke: #4169e1; stroke-width: 2; }
      .process { fill: #e6ffe6; stroke: #32cd32; stroke-width: 2; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="300" y="25" class="title" text-anchor="middle">SDLP Protocol Flow</text>
  
  <!-- Sender Side -->
  <g transform="translate(50, 60)">
    <text x="100" y="-10" class="label" text-anchor="middle" font-weight="bold">SENDER</text>
    
    <!-- Payload box -->
    <rect x="20" y="20" width="160" height="40" class="box" rx="5"/>
    <text x="100" y="35" class="label" text-anchor="middle">Original Payload</text>
    <text x="100" y="50" class="label" text-anchor="middle">(JSON, YAML, etc.)</text>
    
    <!-- Compression -->
    <rect x="20" y="80" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="100" class="label" text-anchor="middle">Compress (Brotli/Gzip)</text>
    
    <!-- Create Metadata -->
    <rect x="20" y="130" width="160" height="40" class="process" rx="5"/>
    <text x="100" y="145" class="label" text-anchor="middle">Create Core Metadata</text>
    <text x="100" y="160" class="label" text-anchor="middle">(type, chk, comp, DID)</text>
    
    <!-- Sign with DID -->
    <rect x="20" y="190" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="210" class="label" text-anchor="middle">Sign with DID Private Key</text>
    
    <!-- Generate Link -->
    <rect x="20" y="240" width="160" height="40" class="box" rx="5"/>
    <text x="100" y="255" class="label" text-anchor="middle">SDLP Link</text>
    <text x="100" y="270" class="label" text-anchor="middle">scheme://&lt;metadata&gt;.&lt;payload&gt;</text>
  </g>
  
  <!-- Arrows from sender -->
  <line x1="130" y1="120" x2="130" y2="140" class="arrow"/>
  <line x1="130" y1="170" x2="130" y2="190" class="arrow"/>
  <line x1="130" y1="220" x2="130" y2="240" class="arrow"/>
  <line x1="130" y1="110" x2="130" y2="130" class="arrow"/>
  
  <!-- Transmission arrow -->
  <line x1="230" y1="260" x2="370" y2="260" class="arrow"/>
  <text x="300" y="250" class="label" text-anchor="middle">Transmit via</text>
  <text x="300" y="275" class="label" text-anchor="middle">Deep Link</text>
  
  <!-- Receiver Side -->
  <g transform="translate(390, 60)">
    <text x="100" y="-10" class="label" text-anchor="middle" font-weight="bold">RECEIVER</text>
    
    <!-- Receive Link -->
    <rect x="20" y="20" width="160" height="40" class="box" rx="5"/>
    <text x="100" y="35" class="label" text-anchor="middle">Parse SDLP Link</text>
    <text x="100" y="50" class="label" text-anchor="middle">Split metadata.payload</text>
    
    <!-- Resolve DID -->
    <rect x="20" y="80" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="100" class="label" text-anchor="middle">Resolve DID Document</text>
    
    <!-- Verify Signature -->
    <rect x="20" y="130" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="150" class="label" text-anchor="middle">Verify JWS Signature</text>
    
    <!-- Decompress -->
    <rect x="20" y="180" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="200" class="label" text-anchor="middle">Decompress Payload</text>
    
    <!-- Verify Integrity -->
    <rect x="20" y="230" width="160" height="30" class="process" rx="5"/>
    <text x="100" y="250" class="label" text-anchor="middle">Verify SHA-256 Checksum</text>
    
    <!-- Final Payload -->
    <rect x="20" y="280" width="160" height="40" class="box" rx="5"/>
    <text x="100" y="295" class="label" text-anchor="middle">Authenticated Payload</text>
    <text x="100" y="310" class="label" text-anchor="middle">(Ready for Processing)</text>
  </g>
  
  <!-- Arrows for receiver -->
  <line x1="470" y1="60" x2="470" y2="80" class="arrow"/>
  <line x1="470" y1="110" x2="470" y2="130" class="arrow"/>
  <line x1="470" y1="160" x2="470" y2="180" class="arrow"/>
  <line x1="470" y1="210" x2="470" y2="230" class="arrow"/>
  <line x1="470" y1="260" x2="470" y2="280" class="arrow"/>
  
  <!-- Security indicators -->
  <g transform="translate(250, 350)">
    <circle cx="0" cy="0" r="8" fill="#32cd32"/>
    <text x="15" y="5" class="label">Authentication via DID Resolution</text>
    <circle cx="180" cy="0" r="8" fill="#32cd32"/>
    <text x="195" y="5" class="label">Integrity via SHA-256 Checksum</text>
  </g>
</svg>